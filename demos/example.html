<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Response Viewer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.1/umd/lucide.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

        body {
            font-family: 'Inter', sans-serif;
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(229, 231, 235, 0.5);
        }

        /* Hide scrollbar for cleaner look */
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f5f9;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        .selected-card {
            border-color: #3b82f6;
            background-color: #eff6ff;
            box-shadow: 0 4px 6px -1px rgba(59, 130, 246, 0.1), 0 2px 4px -1px rgba(59, 130, 246, 0.06);
        }
    </style>
</head>

<body class="bg-slate-50 text-slate-800 min-h-screen">

    <!-- Navbar -->
    <nav class="bg-white border-b border-slate-200 sticky top-0 z-10 px-4 py-3 shadow-sm">
        <div class="max-w-6xl mx-auto flex justify-between items-center">
            <div class="flex items-center gap-2">
                <div class="bg-blue-600 text-white p-1.5 rounded-lg">
                    <i data-lucide="database" class="w-5 h-5"></i>
                </div>
                <h1 class="font-bold text-lg text-slate-800">API Inspector <span
                        class="text-slate-400 font-normal text-sm ml-2">Maximo OS/MXWO</span></h1>
            </div>
            <div class="flex items-center gap-3">
                <button onclick="resetSelection()"
                    class="text-xs font-medium text-slate-500 hover:text-blue-600 transition-colors">Reset View</button>
                <div class="text-xs font-mono bg-slate-100 text-slate-500 px-2 py-1 rounded border border-slate-200">
                    JSON
                </div>
            </div>
        </div>
    </nav>

    <main class="max-w-6xl mx-auto p-4 md:p-6 space-y-6">

        <!-- Stats Overview -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm flex items-center justify-between">
                <div>
                    <p class="text-sm text-slate-500 font-medium">Total Records</p>
                    <p class="text-2xl font-bold text-slate-800" id="total-count">0</p>
                </div>
                <div class="bg-blue-50 text-blue-600 p-2 rounded-lg">
                    <i data-lucide="list" class="w-5 h-5"></i>
                </div>
            </div>
            <div class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm flex items-center justify-between">
                <div>
                    <p class="text-sm text-slate-500 font-medium">Current Page</p>
                    <p class="text-2xl font-bold text-slate-800" id="page-num">1</p>
                </div>
                <div class="bg-emerald-50 text-emerald-600 p-2 rounded-lg">
                    <i data-lucide="file-digit" class="w-5 h-5"></i>
                </div>
            </div>
            <div class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm flex items-center justify-between">
                <div>
                    <p class="text-sm text-slate-500 font-medium">Data Source</p>
                    <p class="text-sm font-semibold text-slate-800 truncate w-32 md:w-48"
                        title="manage.edf-rba.ssw-demos.com">...ssw-demos.com</p>
                </div>
                <div class="bg-violet-50 text-violet-600 p-2 rounded-lg">
                    <i data-lucide="server" class="w-5 h-5"></i>
                </div>
            </div>
        </div>

        <!-- Main Content Area -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">

            <!-- List View -->
            <div class="lg:col-span-2 space-y-4">
                <div class="flex justify-between items-center">
                    <h2 class="font-semibold text-lg flex items-center gap-2">
                        <i data-lucide="table-2" class="w-5 h-5 text-slate-400"></i>
                        Record List
                    </h2>
                    <span class="text-xs text-slate-500 bg-white border px-2 py-1 rounded-full">Decoded IDs</span>
                </div>

                <div id="record-list" class="space-y-3">
                    <!-- Cards injected via JS -->
                </div>

                <!-- Pagination Controls -->
                <div class="flex justify-between items-center pt-4" id="pagination-controls">
                    <!-- Injected via JS -->
                </div>
            </div>

            <!-- Details / Raw JSON Sidebar -->
            <div class="lg:col-span-1 space-y-4">
                <div class="flex justify-between items-center">
                    <h2 class="font-semibold text-lg flex items-center gap-2">
                        <i id="panel-icon" data-lucide="info" class="w-5 h-5 text-slate-400"></i>
                        <span id="panel-title">Details</span>
                    </h2>
                    <div class="flex bg-slate-100 p-1 rounded-lg">
                        <button onclick="setRightPanelMode('details')" id="btn-mode-details"
                            class="px-3 py-1 text-xs font-medium rounded-md shadow-sm bg-white text-slate-700 transition-all">Details</button>
                        <button onclick="setRightPanelMode('raw')" id="btn-mode-raw"
                            class="px-3 py-1 text-xs font-medium rounded-md text-slate-500 hover:text-slate-700 transition-all">Raw
                            JSON</button>
                    </div>
                </div>

                <!-- Details Panel Content -->
                <div id="details-panel"
                    class="bg-white rounded-xl border border-slate-200 shadow-lg h-[600px] flex flex-col relative overflow-hidden">
                    <!-- Empty State -->
                    <div id="empty-state"
                        class="absolute inset-0 flex flex-col items-center justify-center text-center p-6 bg-slate-50/50">
                        <div class="bg-white p-4 rounded-full shadow-sm mb-4">
                            <i data-lucide="mouse-pointer-click" class="w-8 h-8 text-slate-300"></i>
                        </div>
                        <h3 class="text-slate-900 font-medium mb-1">Select a Record</h3>
                        <p class="text-slate-500 text-sm">Click on any work order card on the left to view its details.
                        </p>
                    </div>

                    <!-- Content (Hidden by default) -->
                    <div id="details-content" class="hidden flex-col h-full">
                        <!-- Header -->
                        <div class="p-6 border-b border-slate-100 bg-slate-50/50">
                            <div class="flex justify-between items-start mb-4">
                                <div>
                                    <span id="detail-site"
                                        class="text-xs font-bold text-slate-400 tracking-wider">BEDFORD</span>
                                    <h2 id="detail-id" class="text-2xl font-bold text-slate-800">2006</h2>
                                </div>
                                <span id="detail-status"
                                    class="px-2.5 py-1 rounded-full text-xs font-bold bg-green-100 text-green-700">APPR</span>
                            </div>
                            <p id="detail-desc" class="text-slate-600 font-medium">Replace Pump Seal</p>
                        </div>

                        <!-- Info Grid -->
                        <div class="p-6 space-y-6 overflow-y-auto flex-1 custom-scrollbar">
                            <div class="grid grid-cols-2 gap-4">
                                <div class="space-y-1">
                                    <span class="text-xs text-slate-400 uppercase font-semibold">Asset</span>
                                    <div class="flex items-center gap-2 text-slate-700">
                                        <i data-lucide="box" class="w-4 h-4 text-slate-400"></i>
                                        <span id="detail-asset" class="font-medium">PUMP-101</span>
                                    </div>
                                </div>
                                <div class="space-y-1">
                                    <span class="text-xs text-slate-400 uppercase font-semibold">Location</span>
                                    <div class="flex items-center gap-2 text-slate-700">
                                        <i data-lucide="map-pin" class="w-4 h-4 text-slate-400"></i>
                                        <span id="detail-location" class="font-medium">BR-200</span>
                                    </div>
                                </div>
                            </div>

                            <div class="border-t border-slate-100 pt-4">
                                <span
                                    class="text-xs text-slate-400 uppercase font-semibold block mb-2">Scheduling</span>
                                <div class="space-y-3">
                                    <div class="flex justify-between text-sm">
                                        <span class="text-slate-500">Target Start</span>
                                        <span id="detail-start" class="font-mono text-slate-700">2023-11-01</span>
                                    </div>
                                    <div class="flex justify-between text-sm">
                                        <span class="text-slate-500">Target Finish</span>
                                        <span id="detail-finish" class="font-mono text-slate-700">2023-11-05</span>
                                    </div>
                                </div>
                            </div>

                            <div class="border-t border-slate-100 pt-4">
                                <span
                                    class="text-xs text-slate-400 uppercase font-semibold block mb-2">Responsibility</span>
                                <div class="flex items-center gap-3">
                                    <div
                                        class="w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-bold text-xs">
                                        JS
                                    </div>
                                    <div>
                                        <p class="text-sm font-medium text-slate-700">John Smith</p>
                                        <p class="text-xs text-slate-400">Supervisor</p>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-blue-50 p-3 rounded-lg border border-blue-100 mt-4">
                                <div class="flex gap-2">
                                    <i data-lucide="info" class="w-4 h-4 text-blue-500 mt-0.5"></i>
                                    <p class="text-xs text-blue-700 leading-relaxed">
                                        This data is simulated for demonstration purposes as the original API response
                                        only contained links.
                                    </p>
                                </div>
                            </div>
                        </div>

                        <div class="p-4 border-t border-slate-100 bg-slate-50 flex gap-2">
                            <button
                                class="flex-1 bg-white border border-slate-300 text-slate-700 py-2 rounded-lg text-sm font-medium hover:bg-slate-50 shadow-sm transition-colors">History</button>
                            <button
                                class="flex-1 bg-blue-600 text-white py-2 rounded-lg text-sm font-medium hover:bg-blue-700 shadow-sm transition-colors">Actions</button>
                        </div>
                    </div>
                </div>

                <!-- Raw JSON Panel (Hidden by default) -->
                <div id="raw-panel"
                    class="hidden bg-slate-900 rounded-xl overflow-hidden border border-slate-700 shadow-lg h-[600px] flex flex-col">
                    <div
                        class="flex items-center justify-between px-4 py-2 bg-slate-800 border-b border-slate-700 flex-shrink-0">
                        <span class="text-xs text-slate-400 font-mono">response.json</span>
                        <button onclick="copyToClipboard()" class="text-slate-400 hover:text-white transition-colors">
                            <i data-lucide="copy" class="w-4 h-4"></i>
                        </button>
                    </div>
                    <pre class="p-4 text-xs font-mono text-emerald-400 overflow-x-auto overflow-y-auto custom-scrollbar flex-1"
                        id="raw-json"></pre>
                </div>
            </div>
        </div>
    </main>

    <script>
        // The Data provided by user
        const apiData = {
            "member": [
                { "href": "https://poc-ui.manage.edf-rba.ssw-demos.com/maximo/api/os/mxwo/_QkVERk9SRC8yMDA2" },
                { "href": "https://poc-ui.manage.edf-rba.ssw-demos.com/maximo/api/os/mxwo/_QkVERk9SRC83MjEx" },
                { "href": "https://poc-ui.manage.edf-rba.ssw-demos.com/maximo/api/os/mxwo/_QkVERk9SRC81MDA4" },
                { "href": "https://poc-ui.manage.edf-rba.ssw-demos.com/maximo/api/os/mxwo/_QkVERk9SRC8yOTU0" },
                { "href": "https://poc-ui.manage.edf-rba.ssw-demos.com/maximo/api/os/mxwo/_QkVERk9SRC8yMTU1" },
                { "href": "https://poc-ui.manage.edf-rba.ssw-demos.com/maximo/api/os/mxwo/_QkVERk9SRC8yMDA1" },
                { "href": "https://poc-ui.manage.edf-rba.ssw-demos.com/maximo/api/os/mxwo/_QkVERk9SRC8yNDMz" },
                { "href": "https://poc-ui.manage.edf-rba.ssw-demos.com/maximo/api/os/mxwo/_QkVERk9SRC83MjAw" },
                { "href": "https://poc-ui.manage.edf-rba.ssw-demos.com/maximo/api/os/mxwo/_QkVERk9SRC8yMDAx" },
                { "href": "https://poc-ui.manage.edf-rba.ssw-demos.com/maximo/api/os/mxwo/_QkVERk9SRC82MDAw" }
            ],
            "href": "https://poc-ui.manage.edf-rba.ssw-demos.com/maximo/api/os/mxwo",
            "responseInfo": {
                "nextPage": {
                    "href": "https://poc-ui.manage.edf-rba.ssw-demos.com/maximo/api/os/mxwo?pageno=2&oslc.pageSize=10&lean=1"
                },
                "href": "https://poc-ui.manage.edf-rba.ssw-demos.com/maximo/api/os/mxwo?oslc.pageSize=10&lean=1",
                "pagenum": 1
            }
        };

        // State
        let selectedHref = null;
        let rightPanelMode = 'details'; // 'details' or 'raw'

        // Mock Data Generators
        const descriptions = ["Pump vibration analysis needed", "Annual HVAC System Inspection", "Fix leaking seal on Line 4", "Replace filter in Unit B", "Safety inspection: Fire Extinguishers", "Motor replacement - Conveyor 3", "General housekeeping - Zone A", "Electrical Fault Investigation", "Oil Change - Fleet Truck 9", "Pressure Gauge Calibration"];
        const statuses = ["WAPPR", "APPR", "INPRG", "COMP", "CLOSE"];
        const assets = ["PUMP-101", "HVAC-200", "CONV-55", "ELEC-BOX-2", "FLEET-009", "COMP-AIR-1"];
        const locations = ["ROOF-01", "BASEMENT", "PLANT-FL-1", "WORKSHOP", "GARAGE"];

        function getMockDetails(site, id) {
            // Seeded random-ish based on ID for consistency during session
            const seed = parseInt(id.replace(/\D/g, '')) || 1234;

            return {
                id: id,
                site: site,
                description: descriptions[seed % descriptions.length],
                status: statuses[seed % statuses.length],
                asset: assets[seed % assets.length],
                location: locations[seed % locations.length],
                targetStart: new Date(Date.now() + (seed * 100000)).toISOString().split('T')[0],
                targetFinish: new Date(Date.now() + (seed * 500000)).toISOString().split('T')[0]
            };
        }

        // Utility to decode the Maximo Base64 ID
        function decodeMaximoId(url) {
            try {
                const parts = url.split('/');
                let idPart = parts[parts.length - 1];
                if (idPart.startsWith('_')) idPart = idPart.substring(1);
                const decoded = atob(idPart);
                return { original: idPart, decoded: decoded, isDecoded: true };
            } catch (e) {
                return { original: url.split('/').pop(), decoded: url.split('/').pop(), isDecoded: false };
            }
        }

        function setRightPanelMode(mode) {
            rightPanelMode = mode;

            // Toggle Buttons
            const btnDetails = document.getElementById('btn-mode-details');
            const btnRaw = document.getElementById('btn-mode-raw');

            if (mode === 'details') {
                btnDetails.className = "px-3 py-1 text-xs font-medium rounded-md shadow-sm bg-white text-slate-700 transition-all";
                btnRaw.className = "px-3 py-1 text-xs font-medium rounded-md text-slate-500 hover:text-slate-700 transition-all";
                document.getElementById('details-panel').classList.remove('hidden');
                document.getElementById('raw-panel').classList.add('hidden');
                document.getElementById('panel-title').innerText = "Details";
                document.getElementById('panel-icon').setAttribute('data-lucide', 'info');
            } else {
                btnRaw.className = "px-3 py-1 text-xs font-medium rounded-md shadow-sm bg-white text-slate-700 transition-all";
                btnDetails.className = "px-3 py-1 text-xs font-medium rounded-md text-slate-500 hover:text-slate-700 transition-all";
                document.getElementById('details-panel').classList.add('hidden');
                document.getElementById('raw-panel').classList.remove('hidden');
                document.getElementById('raw-panel').classList.add('flex');
                document.getElementById('panel-title').innerText = "Raw Response";
                document.getElementById('panel-icon').setAttribute('data-lucide', 'code-2');
            }
            if (window.lucide) lucide.createIcons();
        }

        function selectRecord(href) {
            selectedHref = href;
            render(); // Re-render list to show highlighting

            // Populate Details
            const idInfo = decodeMaximoId(href);
            const site = idInfo.isDecoded && idInfo.decoded.includes('/') ? idInfo.decoded.split('/')[0] : 'N/A';
            const recordId = idInfo.isDecoded && idInfo.decoded.includes('/') ? idInfo.decoded.split('/')[1] : idInfo.decoded;

            const details = getMockDetails(site, recordId);

            // Update DOM
            document.getElementById('detail-id').innerText = details.id;
            document.getElementById('detail-site').innerText = details.site;
            document.getElementById('detail-desc').innerText = details.description;
            document.getElementById('detail-asset').innerText = details.asset;
            document.getElementById('detail-location').innerText = details.location;
            document.getElementById('detail-start').innerText = details.targetStart;
            document.getElementById('detail-finish').innerText = details.targetFinish;

            // Status Styling
            const statusEl = document.getElementById('detail-status');
            statusEl.innerText = details.status;
            statusEl.className = `px-2.5 py-1 rounded-full text-xs font-bold ${details.status === 'APPR' || details.status === 'COMP' ? 'bg-green-100 text-green-700' :
                    details.status === 'WAPPR' ? 'bg-amber-100 text-amber-700' :
                        'bg-blue-100 text-blue-700'
                }`;

            // Show Content / Hide Empty State
            document.getElementById('empty-state').classList.add('hidden');
            document.getElementById('details-content').classList.remove('hidden');
            document.getElementById('details-content').classList.add('flex');

            // Force switch to details view if in raw view? Optional. Let's keep user context if they are in raw view.
            if (rightPanelMode === 'details') {
                // Ensure visible
            }
        }

        function resetSelection() {
            selectedHref = null;
            document.getElementById('empty-state').classList.remove('hidden');
            document.getElementById('details-content').classList.add('hidden');
            document.getElementById('details-content').classList.remove('flex');
            render();
        }

        function render() {
            // Stats & JSON
            document.getElementById('total-count').innerText = apiData.member.length;
            document.getElementById('page-num').innerText = apiData.responseInfo.pagenum;
            document.getElementById('raw-json').innerText = JSON.stringify(apiData, null, 2);

            // Render List
            const listContainer = document.getElementById('record-list');
            listContainer.innerHTML = '';

            apiData.member.forEach((item, index) => {
                const idInfo = decodeMaximoId(item.href);
                const isSelected = item.href === selectedHref;

                // Create Card
                const card = document.createElement('div');
                card.className = `p-4 rounded-xl border transition-all cursor-pointer group ${isSelected
                        ? 'selected-card border-blue-200'
                        : 'bg-white border-slate-200 shadow-sm hover:shadow-md hover:border-slate-300'
                    }`;
                card.onclick = () => selectRecord(item.href);

                const site = idInfo.isDecoded && idInfo.decoded.includes('/') ? idInfo.decoded.split('/')[0] : 'N/A';
                const recordId = idInfo.isDecoded && idInfo.decoded.includes('/') ? idInfo.decoded.split('/')[1] : idInfo.decoded;

                card.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="flex items-start gap-4">
                            <div class="${isSelected ? 'bg-blue-600 text-white' : 'bg-slate-100 text-slate-500 group-hover:bg-blue-50 group-hover:text-blue-600'} p-2.5 rounded-lg transition-colors">
                                <i data-lucide="file-text" class="w-6 h-6"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-slate-800 text-lg">${recordId}</h3>
                                <div class="flex gap-2 text-xs font-mono mt-1">
                                    <span class="${isSelected ? 'bg-blue-100 text-blue-700 border-blue-200' : 'bg-slate-100 text-slate-600 border-slate-200'} px-1.5 py-0.5 rounded border">SITE: ${site}</span>
                                    <span class="text-slate-400">ID: ${idInfo.original.substring(0, 8)}...</span>
                                </div>
                            </div>
                        </div>
                        <div class="${isSelected ? 'text-blue-600' : 'text-slate-300 group-hover:text-blue-400'}">
                            <i data-lucide="chevron-right" class="w-5 h-5"></i>
                        </div>
                    </div>
                `;
                listContainer.appendChild(card);
            });

            // Render Pagination Logic
            const paginationContainer = document.getElementById('pagination-controls');
            if (apiData.responseInfo.nextPage) {
                paginationContainer.innerHTML = `
                    <span class="text-sm text-slate-500">Showing page ${apiData.responseInfo.pagenum}</span>
                    <a href="#" class="flex items-center gap-2 px-4 py-2 bg-white border border-slate-200 text-slate-700 text-sm font-medium rounded-lg hover:bg-slate-50 transition-colors">
                        Next Page
                        <i data-lucide="chevron-right" class="w-4 h-4"></i>
                    </a>
                `;
            } else {
                paginationContainer.innerHTML = `<span class="text-sm text-slate-500">End of results</span>`;
            }

            // Init Icons
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            } else {
                console.warn('Lucide not loaded immediately, waiting for load event.');
            }
        }

        function copyToClipboard() {
            const text = JSON.stringify(apiData, null, 2);
            navigator.clipboard.writeText(text).then(() => {
                alert('JSON copied to clipboard');
            });
        }

        // Init - Wait for window load to ensure external scripts (lucide) are ready
        window.addEventListener('load', render);

    </script>
</body>

</html>